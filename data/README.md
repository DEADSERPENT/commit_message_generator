# Data format

## Train / validation / test

- **train.jsonl** — one JSON object per line for training.
- **val.jsonl** — validation set (used for early stopping / best checkpoint).
- **test.jsonl** — optional; use for final BLEU/ROUGE/METEOR reporting.

## JSON schema (per line)

```json
{"diff": "<raw git diff text>", "message": "<commit message>"}
```

- **diff**: Full diff (e.g. with `diff --git`, `---`/`+++`, `@@` hunks, `+`/`-` lines). Preprocessing will clean and normalize it.
- **message**: Single-line commit message (first line of the commit). Preprocessing lowercases and trims to `max_msg_words` (see `configs/default.yaml` → `data.max_msg_words`).

## Source (CommitBench)

When using the download script, data comes from [Maxscha/commitbench](https://huggingface.co/datasets/Maxscha/commitbench): GitHub commits (Diff, Commit Message, Hash, Project, Split). We only use Diff and Commit Message and respect the provided train/validation/test split.

## Tokenizer corpus

`sp_corpus.txt` is generated by `python -m src.prepare_data` from `train.jsonl` (diffs and messages, one sentence per line). It is used to train the SentencePiece model `sp_model.model`; vocab size and path come from `configs/default.yaml` → `tokenizer`.
